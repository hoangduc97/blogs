!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=20)}([function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("express-validator")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("bcryptjs")},function(e,t){e.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-jwt")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("redis")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/inherits")},function(e,t){e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime/helpers/wrapNativeSuper")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("winston")},function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(1),c=r.n(s),o=r(5),u=r.n(o),i=r(11),l=r.n(i),f=r(12),p=r.n(f),d=r(2),h=r.n(d),m={useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1,useCreateIndex:!0},g={connect_mongo:function(){return h.a.connect("mongodb+srv://zrik:Bongtoi1@blogs.5dzkz.mongodb.net/blogs?retryWrites=true&w=majority",m)}},v=r(4),w=r.n(v),y=r(3),b=r(6),x=r.n(b),k=r(7),_=r.n(k),X=new h.a.Schema({email:{type:String,unique:!0,trim:!0},hash:{type:String,required:!0}});X.pre("save",(function(e){var t=this;this.isModified("hash")||this.isNew?_.a.genSalt(10,(function(r,n){if(r)return e(r);_.a.hash(t.hash,n,(function(r,n){if(r)return e(r);t.hash=n,e()}))})):e()})),X.methods.compareHash=function(e,t){_.a.compare(e,this.hash,(function(e,r){if(e)return t(e);t(null,r)}))};var j=h.a.model("Account",X),O=new h.a.Schema({account:j.schema,username:{type:String,default:""},avatar_url:{type:String,default:"url://"},role:{type:Number,enum:[0,1,2],required:!0},bookmark_article:[{type:h.a.Schema.Types.ObjectId,ref:"Article"}]},{timestamps:!0}),q=h.a.model("User",O),S=r(13),C=r.n(S).a.createClient("18620","redis-18620.c244.us-east-1-2.ec2.cloud.redislabs.com",{no_ready_check:!0});C.auth("HeFHDTB9xIKo2RXcI6hlt78fhCBtAUho"),C.on("connect",(function(){console.log("redis is connected!")})),C.on("ready",(function(){console.log("Client connected to redis and ready to use...")})),C.on("error",(function(e){console.log(e.message)})),C.on("end",(function(){console.log("Client disconnected from redis")})),process.on("SIGINT",(function(){C.quit()}));var I=C,T={3e3:"Please enter a valid email",3001:"Please enter a valid password",1301:"Invalid Register Type",1302:"Invalid Login Type",1303:"User already exists",1304:"Register Error",2304:"Register success",1305:"Login Error",2305:"Login success",2100:"Data Found",1100:"Not Found",2101:"Refresh token success",1306:"Logout refresh token not found",1307:"Refresh token invalid",5e3:"Internal server error",1308:"Invalid category type",1309:"Category existed",2310:"Create category successful",1310:"Create category error",2311:"Update category successful",1311:"Update category error",1312:"Category not exist",2313:"Delete category successful",1313:"Delete category error",1314:"Invalid tag type",1315:"Tag existed",2316:"Create tag successful",1316:"Create tag error",2317:"Update tag successful",1317:"Update tag error",1318:"Tag not exist",2319:"Delete tag successful",1319:"Delete tag error",1320:"Invalid article type",1321:"Article title existed",2322:"Create article successful",1322:"Create article error",1323:"Article not exist",2324:"Update article successful",1324:"Update article error",2325:"Delete article successful",1325:"Delete article error",1326:"Invalid comment type",2327:"Create comment successful",1327:"Create comment error",1328:"Comment not exist",2329:"Update comment successful",1329:"Update comment error",2330:"Delete comment successful",1330:"Delete comment error"},A=r(14),R=r.n(A),E=r(15),D=r.n(E),U=r(16),B=r.n(U),P=r(8),L=r.n(P),N=r(17);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=L()(e);if(t){var a=L()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return B()(this,r)}}var F=function(e){D()(r,e);var t=z(r);function r(e,n,a){var s;return R()(this,r),(s=t.call(this)).statusCode=e,s.message=n,s.errorCode=a,s}return r}(r.n(N)()(Error)),M=function(e,t){var r=e.statusCode,n=e.message,a=e.errorCode;return t.status(r).json({success:!1,message:n,error_code:a})},H=0,G=1,K=2,J=200,W=201,Q=204,V=400,Y=401,Z=403,$=function(e){if(e&&e.authorization){var t=e.authorization.split(" ");if(t&&2===t.length)return x.a.verify(t[1],"XXXXXXXXXXXX")}return null},ee=function(e){if(e){var t=x.a.sign({_id:e._id,role:e.role},"XXXXXXXXXXXX",{expiresIn:"30m"});return"".concat("Bearer"," ").concat(t)}},te=function(e){if(e){var t=x.a.sign({_id:e._id,role:e.role},"XXXXXXXXXXXX",{expiresIn:"30d"});return I.SET(e._id+"",t,"EX",2592e3,(function(e){if(e)throw new Error(e)})),"".concat("Bearer"," ").concat(t)}},re=function(){var e=c()(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split(" "),n=x.a.verify(r[1],"XXXXXXXXXXXX"),e.abrupt("return",new Promise((function(e,t){I.get(n._id+"",(function(r,a){!r&&a?e(n):t(r)}))})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ne(e){return ae.apply(this,arguments)}function ae(){return(ae=c()(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re(t);case 3:return r=e.sent,e.next=6,q.findById(r._id);case 6:if(n=e.sent){e.next=9;break}throw new Error;case 9:return e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),new F(V,T[1307],1307);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function se(e,t){var r={httpOnly:!0,expires:new Date(Date.now()+10944e5)};e.cookie("refreshToken",t,r)}var ce=r(19),oe=new ce.transports.Console,ue=(new ce.transports.File({filename:"./error.log",level:"error"}),new ce.transports.File({filename:"./rest.log"}),{transports:[oe]}),ie=new ce.createLogger(ue),le=ie;function fe(e,t,r){ie.info(e.url),r()}var pe=function(){var e=c()(a.a.mark((function e(t,r,n){var s,o,u,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1301],1301);case 5:return o=t.body,u=o.email,i=o.password,e.next=8,q.exists({"account.email":u});case 8:if(!e.sent){e.next=11;break}throw new F(V,T[1303],1303);case 11:return e.next=13,q.create({role:K,account:{email:u,hash:i}}).then(function(){var e=c()(a.a.mark((function e(t){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee(t),s=te(t),se(r,s),e.abrupt("return",r.status(W).json({success:!0,message:T[2304],user:{username:t.username,avatar_url:t.avatar_url,bookmark_article:t.bookmark_article,_id:t._id,email:t.account.email},token:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw le.error(e),new F(V,T[1304],1304)}));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),n(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,r,n){return e.apply(this,arguments)}}(),de=function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o,u,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1302],1302);case 5:return c=t.body,o=c.email,u=c.password,e.next=8,q.findOne({"account.email":o});case 8:if(i=e.sent){e.next=11;break}throw new F(Y,T[1305],1305);case 11:i.account.compareHash(u,(function(e,t){if(t&&!e){var n=ee(i),a=te(i);return se(r,a),r.status(J).json({success:!0,message:T[2305],user:{username:i.username,avatar_url:i.avatar_url,bookmark_article:i.bookmark_article,_id:i._id,email:i.account.email},token:n})}throw new F(Y,T[1305],1305)})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),n(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,r,n){return e.apply(this,arguments)}}(),he=function(){var e=c()(a.a.mark((function e(t,r,n){var s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=t.cookies.refreshToken,e.next=4,ne(s);case 4:return c=e.sent,e.next=7,I.DEL(c._id+"");case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:r.sendStatus(Q);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,r,n){return e.apply(this,arguments)}}(),me=function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=t.cookies.refreshToken,e.next=4,ne(s);case 4:c=e.sent,o=ee(c),u=te(c),se(r,u),r.status(J).json({success:!0,message:T[2101],user:{username:c.username,avatar_url:c.avatar_url,bookmark_article:c.bookmark_article,_id:c._id,email:c.account.email},token:o}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),n(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,r,n){return e.apply(this,arguments)}}(),ge={register:pe,login:de,logout:he,getAll:function(){var e=c()(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{q.find({}).then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),refreshToken:me},ve=r(9),we=r.n(ve),ye=r(10),be=r.n(ye),xe={jwtFromRequest:be.a.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:"XXXXXXXXXXXX"};we.a.use(new be.a.Strategy(xe,(function(e,t){q.findOne({_id:e._id},(function(e,r){e&&t(e,!1),t(null,r||!1)}))})));var ke=we.a,_e=function(e){return function(t,r,n){ke.authenticate("jwt",{session:!1},(function(t,a){return t||!a?r.status(Z).json({message:"forbidden"}):e.includes(a.role)?void n():r.status(Z).json({message:"forbidden"})}))(t,r,n)}},Xe=[Object(y.check)("email",T[3e3]).isEmail(),Object(y.check)("password",T[3001]).isLength({min:6})],je=u.a.Router();je.post("/register",w()(Xe),ge.register),je.post("/login",w()(Xe),ge.login),je.post("/refresh_token",ge.refreshToken),je.delete("/logout",ge.logout),je.get("/",_e([H]),ge.getAll);var Oe=je,qe=function(){var e=c()(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.exists(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Se=(r(18),function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ|Đ/g,"d").replace(/ /g,"-").toLowerCase()}),Ce=new h.a.Schema({author:{type:h.a.Schema.Types.ObjectId,ref:"User",required:!0},category:{type:h.a.Schema.Types.ObjectId,ref:"Category",required:!0},tags:[{type:h.a.Schema.Types.ObjectId,ref:"Tag"}],title:{type:String,required:!0},slug:{type:String,required:!0,unique:!0,lowercase:!0},content:{type:String,required:!0},bookmark_user:[{type:h.a.Schema.Types.ObjectId,ref:"User"}],published:{type:Boolean,required:!0,default:!0},comments:[{type:h.a.Schema.Types.ObjectId,ref:"Comment"}]},{timestamps:!0}),Ie=h.a.model("Article",Ce),Te={_getAll:function(){var e=c()(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Ie.find({}).populate("author").populate("tags").populate("category").exec().then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_getOne:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s={_id:t.params.id},Ie.findOne(s).populate("author").populate("tags").populate("category").exec().then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_create:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1320],1320);case 5:return e.next=7,$(t.headers);case 7:return c=e.sent,o={author:c._id,title:t.body.title,slug:Se(t.body.title),content:t.body.content,tags:t.body.tags?w()(t.body.tags):[],category:t.body.category},e.next=11,qe(Ie,{slug:o.slug});case 11:if(!e.sent){e.next=14;break}throw new F(V,T[1321],1321);case 14:Ie.create(o).then((function(e){return r.status(W).json({success:!0,message:T[2322],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1322],1322)})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),n(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_update:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1320],1320);case 5:return e.next=7,$(t.headers);case 7:return c=e.sent,o={_id:t.body._id,author:c._id},e.next=11,qe(Ie,o);case 11:if(e.sent){e.next=14;break}throw new F(V,T[1323],1323);case 14:u={author_id:c._id,title:t.body.title,slug:Se(t.body.title),content:t.body.content,tags:t.body.tags?w()(t.body.tags):[],category:t.body.category},Ie.findOneAndUpdate(o,u,{new:!0}).then((function(e){return r.status(J).json({success:!0,message:T[2324],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1324],1324)})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),n(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_delete:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={_id:t.params.id},e.next=4,qe(Ie,s);case 4:if(e.sent){e.next=7;break}throw new F(V,T[1323],1323);case 7:Ie.findByIdAndDelete(s).then((function(e){return r.status(J).json({success:!0,message:T[2325],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1325],1325)})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),n(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r,n){return e.apply(this,arguments)}}()},Ae=[Object(y.check)("title").notEmpty().isLength({min:10}),Object(y.check)("category").notEmpty().isMongoId(),Object(y.check)("content").notEmpty().isLength({min:10})],Re=u.a.Router();Re.get("/",Te._getAll),Re.get("/:id",Te._getOne),Re.post("/",[_e([H,G])].concat(w()(Ae)),Te._create),Re.put("/:id",[_e([H,G])].concat(w()(Ae)),Te._update),Re.delete("/:id",[_e([H,G])],Te._delete);var Ee=Re,De=[Object(y.check)("title").notEmpty()],Ue=new h.a.Schema({title:{type:String,unique:!0,required:!0},slug:{type:String,unique:!0,lowercase:!0},count_article:{type:Number,default:0},articles:[{type:h.a.Schema.Types.ObjectID,ref:"Article"}]}),Be=h.a.model("Tag",Ue),Pe={_getAll:function(){var e=c()(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Be.find({}).then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_getOne:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s={_id:t.params.id},Be.find(s).then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_create:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=Object(y.validationResult)(t)).isEmpty()){e.next=4;break}throw le.error(s),new F(V,T[1314],1314);case 4:return e.prev=4,c={title:t.body.title,slug:Se(t.body.title)},o={slug:c.slug},e.next=9,qe(Be,o);case 9:if(!e.sent){e.next=14;break}throw new F(V,T[1315],1315);case 14:Be.create(c).then((function(e){return r.status(W).json({success:!0,message:T[2316],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1316],1316)}));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),n(e.t0);case 20:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_update:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={title:t.body.title,slug:Se(t.body.title)},c={_id:t.params.id},e.next=5,qe(Be,c);case 5:if(!e.sent){e.next=10;break}Be.findOneAndUpdate(c,s,{new:!0}).then((function(e){return r.status(J).json({success:!0,message:T[2317],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1317],1317)})),e.next=11;break;case 10:throw new F(V,T[1318],1318);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),n(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_delete:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={_id:t.param.id},e.next=4,qe(Be,s);case 4:if(!e.sent){e.next=9;break}Be.findByIdAndDelete(s).then((function(e){return r.status(J).json({success:!0,message:T[2319],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1319],1319)})),e.next=10;break;case 9:throw new F(V,T[1318],1318);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),n(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r,n){return e.apply(this,arguments)}}()},Le=u.a.Router();Le.get("/",Pe._getAll),Le.get("/:id",Pe._getOne),Le.post("/",[_e([H,G])].concat(w()(De)),Pe._create),Le.put("/:id",[_e([H,G])].concat(w()(De)),Pe._update),Le.delete("/:id",[_e([H,G])],Pe._delete);var Ne=Le,ze=new h.a.Schema({title:{type:String,unique:!0,required:!0},slug:{type:String,unique:!0,lowercase:!0},count_article:{type:Number,default:0}},{timestamps:!0}),Fe=h.a.model("Category",ze),Me={_getAll:function(){var e=c()(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Fe.find({}).then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_getOne:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s={_id:t.params.id},Fe.find(s).then((function(e){return r.status(J).json({success:!0,message:T[2100],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1100],1100)}))}catch(e){n(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_create:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1308],1308);case 5:return c={title:t.body.title,slug:Se(t.body.title)},o={slug:c.slug},e.next=9,qe(Fe,o);case 9:if(!e.sent){e.next=14;break}throw new F(V,T[1309],1309);case 14:Fe.create(c).then((function(e){return r.status(W).json({success:!0,message:T[2310],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1310],1310)}));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),n(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_update:function(){var e=c()(a.a.mark((function e(t,r,n){var s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(s=Object(y.validationResult)(t)).isEmpty()){e.next=5;break}throw le.error(s),new F(V,T[1308],1308);case 5:return c={title:t.body.title,slug:Se(t.body.title)},o={_id:t.params.id},e.next=9,qe(Fe,o);case 9:if(!e.sent){e.next=14;break}Fe.findOneAndUpdate(o,c,{new:!0}).then((function(e){return r.status(J).json({success:!0,message:T[2311],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1311],1311)})),e.next=15;break;case 14:throw new F(V,T[1312],1312);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),n(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,r,n){return e.apply(this,arguments)}}(),_delete:function(){var e=c()(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={_id:t.param.id},e.next=4,qe(Fe,s);case 4:if(!e.sent){e.next=9;break}Fe.findByIdAndDelete(s).then((function(e){return r.status(J).json({success:!0,message:T[2313],data:e})})).catch((function(e){throw le.error(e),new F(V,T[1313],1313)})),e.next=10;break;case 9:throw new F(V,T[1312],1312);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),n(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r,n){return e.apply(this,arguments)}}()},He=[Object(y.check)("title").notEmpty().isString()],Ge=u.a.Router();Ge.get("/",Me._getAll),Ge.get("/:id",Me._getOne),Ge.post("/",[_e([H,G])].concat(w()(He)),Me._create),Ge.put("/:id",[_e([H,G])].concat(w()(He)),Me._update),Ge.delete("/:id",[_e([H,G])],Me._delete);var Ke=Ge,Je=u.a.Router();Je.use("/auth",Oe),Je.use("/article",Ee),Je.use("/tag",Ne),Je.use("/category",Ke);var We=Je,Qe={origin:"dev"==="dev"?"http://localhost":"http://zrik.info",optionSuccessStatus:200},Ve=function(){var e=c()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=u()()).use(u.a.json()),t.use(u.a.urlencoded({extended:!1})),t.use(p()()),t.use(l()(Qe)),t.use(ke.initialize()),t.use(fe),t.use("/api/v1",We),e.next=10,g.connect_mongo().then((function(){console.log("connect database success!")})).catch((function(e){console.error(e)}));case 10:return t.use((function(e,t,r,n){if(500===e.statusCode)return r.status(500).send();M(e,r)})),e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve();case 2:e.sent.listen("3000",(function(){console.log("server running with port ".concat("3000"))}));case 4:case"end":return e.stop()}}),e)})))()}]);